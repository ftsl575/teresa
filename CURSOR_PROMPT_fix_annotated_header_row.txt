ROLE
You are Cursor acting inside this repo as an AI pair programmer.
Goal: fix annotated.xlsx header parsing in our spot-check tooling/tests.
Constraints: NO GUESSES. Minimal deterministic change. Do not change classifier behavior, rules, or goldens unless strictly required (it should not be).

PROBLEM (repro)
Our *_annotated.xlsx files are not “pure tables” starting at row 1.
They include a “Solution Info” preamble block at the top, and the real table header row appears later (example headers include: Group Name, Group ID, Module Name, Option ID, Entity Type, State, device_type, hw_type).
Any code/tests/scripts that assume ws[1] contains headers fails (we observed headers row returning all None and KeyError for option_id).

TASK
1) Identify where in repo we read annotated.xlsx headers for spot-check / tests (likely in tests that inspect annotated output or any helper used by those tests).
2) Implement robust header-row detection:
   - Scan the first N rows (e.g., 1..60) to find the first row that contains the required header(s).
   - Anchor on presence of “Option ID” (preferred) OR a set of required columns (e.g., Option ID + Entity Type + State + device_type + hw_type).
   - Once found, treat that row as the header row and parse subsequent rows relative to it.
   - Do NOT assume header row is row 1.
3) Update or add a regression-style test ensuring this works:
   - Generate annotated output for one dataset (dl3 or dl4) via existing pipeline invocation used in tests.
   - Confirm the parser can locate the header row and read key columns.
   - Keep the test deterministic and fast.

FILES TO TOUCH (expected)
- tests/* (the test(s) that read annotated.xlsx)
- tests/helpers.py (only if you need a shared helper)
Do NOT modify:
- rules/dell_rules.yaml
- classifier logic
- golden files

ACCEPTANCE CRITERIA
- `python -m pytest tests\ -v --tb=short` passes.
- The failing scenario “headers row is all None / KeyError option_id” is resolved by header-row detection.
- No changes to classification outputs, rules, or goldens.

VERIFICATION COMMANDS (PowerShell)
1) Full tests:
   python -m pytest "C:\Users\G\Desktop\teresa\dell_spec_classifier\tests\" -v --tb=short

2) (Optional) Local run to regenerate annotated files (if useful for debugging):
   foreach ($n in 1..6) {
       python "C:\Users\G\Desktop\teresa\dell_spec_classifier\main.py" `
           --input "C:\Users\G\Desktop\teresa\dell_spec_classifier\test_data\dl$n.xlsx" `
           --output-dir "C:\Users\G\Desktop\teresa\dell_spec_classifier\output"
   }

DELIVERABLE
A PR/commit that fixes annotated.xlsx parsing by detecting the real header row and updates tests accordingly.
